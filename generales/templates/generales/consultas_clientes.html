{% extends 'base/base.html' %}

{% load static %}

{% block contenido %}

{% load humanize %}
<style>
    /* Ocultar el checkbox original */
    input[type="checkbox"] {
        display: none;
    }

    /* Estilo para el contenedor del checkbox */
    .custom-checkbox {
        display: inline-block;
        width: 15px;
        height: 15px;
        border: 2px solid #23c24b;
        border-radius: 4px;
        position: relative;
        cursor: pointer;
    }

    /* Estado marcado */
    input[type="checkbox"]:checked + .custom-checkbox {
        background-color: #23c24b;
        border-color: #23c24b;
    }

    /* Icono de "check" */
    input[type="checkbox"]:checked + .custom-checkbox::after {
        content: "✔";
        color: rgb(24, 23, 23);
        font-size: 10px;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }
    .hidden{
        display: none;
    }
</style>
<section>
    <div class="row justify-content-center">
        <div class="col-10 mb-6" style="padding-left: 50px;">
            <h6 class="mb-4" style="background-color: antiquewhite;">CUNDINAMARCA</h6>
            <table class="table table-striped display" id="example">
                <thead>
                    <tr>
                        <th><strong>Medio</strong></th>
                        <th><strong>Tipo</strong></th>
                        <th><strong>Municipio</strong></th>
                        <th><strong>Latitud</strong></th>                    
                        <th><strong>Longitud</strong></th>
                        <th data-orderable="false" class="text-center"><strong>Acciones</strong></th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th><strong>Medio</strong></th>
                        <th><strong>Tipo</strong></th>
                        <th><strong>Municipio</strong></th>
                        <th><strong>Latitud</strong></th>
                        <th><strong>Longitud</strong></th>
                        <th data-orderable="false" class="text-center"><strong>Acciones</strong></th>
                    </tr>
                </tfoot>
                <tbody>
                    {% for item in resul %}
                        <tr data-tipo = "{{item.tipo_medio}}">
                            <td>{{item.medio}}</td>
                            <td>{{item.tipo_medio}}</td>
                            <td>{{item.municipio}}</td>
                            <td>{{item.latitud}}</td>
                            <td>{{item.longitud}}</td>
                            <td class="td-actions text-center">
                                <a href="">
                                    <button type="button" rel="tooltip" class="btn btn-warning btn-round">
                                    <i class="material-icons">add</i>
                                    </button>
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="col-2 mb-1">
            <h6 class="mb-4" style="background-color: antiquewhite;">TIPOS DE MEDIOS</h6>
            <div class="filters">
                {% for item in categorias %}
                    <label>
                        <input type="checkbox" class="filter" value = "{{item.tipo_medio}}" onclick="update_list()" checked>
                        <span class="custom-checkbox"></span> {{item.tipo_medio}} {{item.id}}
                    </label><br />
                {% endfor %}
            </div>
        </div>
    </div>
</section>


<script>
    function update_list(){
        
        const filters = document.querySelectorAll(".filter");
        const rows = document.querySelectorAll("#example tbody tr");
        // Función para aplicar el filtro
        function applyFilter() {
            // Obtener los valores seleccionados
            const selectedTypes = Array.from(filters)
                .filter(filter => filter.checked)
                .map(filter => filter.value);
            console.log("SELECT = ", selectedTypes);

            // Mostrar u ocultar filas según los filtros
            rows.forEach(row => {
                const tipo = row.getAttribute("data-tipo");
                if (selectedTypes.includes(tipo)) {
                    row.classList.remove("hidden");
                } else {
                    row.classList.add("hidden");
                }
                
            });

        }

        // Agregar eventos a los checkboxes
        filters.forEach(filter => {
            filter.addEventListener("change", applyFilter);
        });

        // Aplicar filtro inicial
        applyFilter();
    };

    document.addEventListener("DOMContentLoaded", () => {
        update_list();
    });
</script>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- JS de DataTables -->
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

<script>
    $(document).ready(function() {
        $('#example').DataTable({
            pageLength: 20, 
            lengthMenu: [
                [-1, 10, 25, 50], // Valores para seleccionar
                ["Todo", 10, 25, 50] // Etiquetas visibles
            ],
            order: [
                [0, 'asc'], // Primera columna (ID), orden ascendente
                [1, 'asc']  // Segunda columna (Nombre), orden ascendente
            ],
            language: {
                url: "https://cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"
            }
        });
    });
</script>

{% endblock contenido %}
